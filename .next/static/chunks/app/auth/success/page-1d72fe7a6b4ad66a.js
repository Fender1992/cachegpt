(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},803:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},2855:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var s=r(5040);let a="https://slxgfzlralwbpzafbufm.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNseGdmemxyYWx3YnB6YWZidWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NzgwMzQsImV4cCI6MjA3MzU1NDAzNH0.0TRSpP_OxAde0WkVXJohGWIqlJ2CdpiYt6FAh2lz1so",l=a&&o?(0,s.UU)(a,o):(()=>{let e="Supabase is not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables.";return{auth:{getUser:()=>Promise.reject(Error(e)),signInWithPassword:()=>Promise.reject(Error(e)),signUp:()=>Promise.reject(Error(e)),signOut:()=>Promise.reject(Error(e)),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}}),getSession:()=>Promise.reject(Error(e))},from:()=>({select:()=>Promise.reject(Error(e)),insert:()=>Promise.reject(Error(e)),update:()=>Promise.reject(Error(e)),delete:()=>Promise.reject(Error(e))}),rpc:()=>Promise.reject(Error(e))}})();a&&o||console.error("Missing required Supabase environment variables.","\nNEXT_PUBLIC_SUPABASE_URL:",a?"Set":"Missing","\nNEXT_PUBLIC_SUPABASE_ANON_KEY:",o?"Set (hidden)":"Missing","\n\nFor Vercel deployment:","\n1. Go to your Vercel project settings","\n2. Navigate to Environment Variables","\n3. Add both variables for Production environment","\n4. Redeploy your application")},2987:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},4668:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),o=r(63),l=r(2855),n=r(5563),i=r(5105);let c=(0,i.A)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),d=(0,i.A)("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);var u=r(5740),m=r(6154),h=r(5426),x=r(803),g=r(2987);function p(){let[e,t]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[p,b]=(0,a.useState)(""),[y,v]=(0,a.useState)(!1),[f,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),[w,C]=(0,a.useState)(null),A=(0,o.useSearchParams)();(0,a.useEffect)(()=>{let e=A.get("source"),r=A.get("return_to");("cli"===e||"terminal"===r)&&j(!0),(async()=>{let{data:{session:e}}=await l.N.auth.getSession();if(e){if(t(e.access_token),e.user){var r,s;i(e.user.email||""),b((null==(r=e.user.user_metadata)?void 0:r.full_name)||(null==(s=e.user.email)?void 0:s.split("@")[0])||"User")}if(f){k(!0);try{let{error:t}=await l.N.from("cli_auth_sessions").upsert({user_id:e.user.id,access_token:e.access_token,refresh_token:e.refresh_token,user_email:e.user.email||"",expires_at:e.expires_at,status:"authenticated",created_at:new Date().toISOString()},{onConflict:"user_id"});t?console.error("Failed to save CLI session:",t):console.log("✅ CLI session saved for polling")}catch(e){console.error("Error saving CLI session:",e)}}}})()},[A,f]);let S=async t=>{C(t),console.log("\uD83D\uDE80 Auto-capturing ".concat(t," credentials..."));try{let s=null;"claude"===t?s=await _():"chatgpt"===t&&(s=await P()),s||console.log("⚠️ Could not auto-capture token, will require manual entry");let{data:{session:a}}=await l.N.auth.getSession();if(null==a?void 0:a.user){console.log("\uD83D\uDCBE Saving credentials to database...");let{error:o}=await l.N.from("user_provider_credentials").upsert({user_id:a.user.id,provider:t,user_email:r,llm_token:s?btoa(s):null,session_token:e?btoa(e):null,auto_captured:!!s,status:"ready",updated_at:new Date().toISOString()},{onConflict:"user_id,provider"});if(o){console.error("Database save failed:",o),alert("Failed to save credentials to database. Please try again.");return}console.log("✅ Credentials saved successfully!"),alert("✅ ".concat(t," credentials saved! You can now close this window and return to the terminal."))}}catch(e){console.error("Error in handleProviderSelect:",e),alert("An error occurred. Please try again.")}localStorage.setItem("selectedLLMProvider",t),localStorage.setItem("userEmail",r),setTimeout(()=>{try{window.close()}catch(e){console.log("Could not auto-close window")}},2e3)},_=async()=>{try{let t=document.createElement("iframe");t.style.display="none",t.src="https://claude.ai",document.body.appendChild(t),await new Promise(e=>{t.onload=e,setTimeout(e,5e3)});try{var e;let r=t.contentDocument||(null==(e=t.contentWindow)?void 0:e.document);if(r){for(let e of r.cookie.split(";"))if(e.trim().startsWith("sessionKey=")){let r=e.trim().substring(11);return document.body.removeChild(t),r}}}catch(e){console.log("Cross-origin restriction, cannot auto-capture Claude token")}return document.body.removeChild(t),null}catch(e){return console.log("Claude auto-capture failed:",e),null}},P=async()=>{try{let t=document.createElement("iframe");t.style.display="none",t.src="https://chat.openai.com",document.body.appendChild(t),await new Promise(e=>{t.onload=e,setTimeout(e,5e3)});try{var e;let r=t.contentDocument||(null==(e=t.contentWindow)?void 0:e.document);if(r){for(let e of r.cookie.split(";"))if(e.trim().startsWith("__Secure-next-auth.session-token=")){let r=e.trim().substring(33);return document.body.removeChild(t),r}}}catch(e){console.log("Cross-origin restriction, cannot auto-capture ChatGPT token")}return document.body.removeChild(t),null}catch(e){return console.log("ChatGPT auto-capture failed:",e),null}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-2xl w-full",children:[(0,s.jsxs)("div",{className:"glass-card rounded-3xl p-8 text-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:(0,s.jsx)(n.A,{className:"w-10 h-10 text-white"})}),(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Welcome, ",p||"User","!"]}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:r}),(0,s.jsx)("p",{className:"text-gray-400 mb-8",children:N?"Select your LLM provider to continue":"Successfully authenticated with CacheGPT"}),N&&f?(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-300",children:"Choose Your LLM Provider"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>S("chatgpt"),className:"p-4 bg-gray-800/50 hover:bg-gray-700/50 rounded-xl transition-all hover:scale-105 border border-gray-700 hover:border-green-500/50 group",children:[(0,s.jsx)(c,{className:"w-8 h-8 mx-auto mb-2 text-green-500 group-hover:text-green-400"}),(0,s.jsx)("div",{className:"font-semibold",children:"ChatGPT"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"OpenAI"})]}),(0,s.jsxs)("button",{onClick:()=>S("claude"),className:"p-4 bg-gray-800/50 hover:bg-gray-700/50 rounded-xl transition-all hover:scale-105 border border-gray-700 hover:border-purple-500/50 group",children:[(0,s.jsx)(d,{className:"w-8 h-8 mx-auto mb-2 text-purple-500 group-hover:text-purple-400"}),(0,s.jsx)("div",{className:"font-semibold",children:"Claude"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Anthropic"})]}),(0,s.jsxs)("button",{onClick:()=>S("gemini"),className:"p-4 bg-gray-800/50 hover:bg-gray-700/50 rounded-xl transition-all hover:scale-105 border border-gray-700 hover:border-blue-500/50 group",children:[(0,s.jsx)(u.A,{className:"w-8 h-8 mx-auto mb-2 text-blue-500 group-hover:text-blue-400"}),(0,s.jsx)("div",{className:"font-semibold",children:"Gemini"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Google"})]}),(0,s.jsxs)("button",{onClick:()=>S("perplexity"),className:"p-4 bg-gray-800/50 hover:bg-gray-700/50 rounded-xl transition-all hover:scale-105 border border-gray-700 hover:border-orange-500/50 group",children:[(0,s.jsx)(m.A,{className:"w-8 h-8 mx-auto mb-2 text-orange-500 group-hover:text-orange-400"}),(0,s.jsx)("div",{className:"font-semibold",children:"Perplexity"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"AI Search"})]})]}),w&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg",children:(0,s.jsxs)("div",{className:"text-green-400 text-sm",children:["✓ Opening ",w," authentication in terminal..."]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-400",children:"YOUR SESSION TOKEN"}),(0,s.jsxs)("button",{onClick:()=>{e&&(navigator.clipboard.writeText(e),v(!0),setTimeout(()=>v(!1),2e3))},className:"flex items-center gap-2 px-3 py-1 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors text-sm",children:[(0,s.jsx)(h.A,{className:"w-4 h-4"}),y?"Copied!":"Copy"]})]}),e?(0,s.jsx)("div",{className:"font-mono text-xs bg-black/50 rounded-lg p-4 break-all text-gray-300",children:e}):(0,s.jsx)("div",{className:"font-mono text-xs bg-black/50 rounded-lg p-4 text-gray-500",children:"Loading session token..."})]}),(0,s.jsx)("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(x.A,{className:"w-5 h-5 text-blue-400 mt-0.5"}),(0,s.jsxs)("div",{className:"text-left flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2 text-blue-400",children:"Return to Terminal"}),(0,s.jsxs)("ol",{className:"text-sm text-gray-300 space-y-1",children:[(0,s.jsx)("li",{children:"1. Copy the session token above"}),(0,s.jsx)("li",{children:"2. Go back to your terminal"}),(0,s.jsx)("li",{children:"3. Paste the token when prompted"}),(0,s.jsx)("li",{children:"4. Select your LLM provider (ChatGPT, Claude, etc.)"})]})]})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-gray-400 text-sm",children:[(0,s.jsx)(g.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"The terminal is waiting for your token"})]})]})]}),(0,s.jsx)("div",{className:"text-center mt-6 text-sm text-gray-500",children:f&&N?"Select your preferred LLM provider above":"You can close this window after copying the token"})]})})}function b(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex items-center justify-center p-4",children:(0,s.jsx)("div",{className:"max-w-2xl w-full",children:(0,s.jsxs)("div",{className:"glass-card rounded-3xl p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,s.jsx)("h1",{className:"text-xl font-semibold text-white mb-2",children:"Loading..."}),(0,s.jsx)("p",{className:"text-gray-400",children:"Preparing your authentication..."})]})})}),children:(0,s.jsx)(p,{})})}},5105:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(2115),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{color:l="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:c,children:d,...u}=r;return(0,s.createElement)("svg",{ref:o,...a,width:n,height:n,stroke:l,strokeWidth:c?24*Number(i)/Number(n):i,className:"lucide lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),...u},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...(Array.isArray(d)?d:[d])||[]])});return r.displayName="".concat(e),r}},5426:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},5563:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},5740:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},6154:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},8041:(e,t,r)=>{Promise.resolve().then(r.bind(r,4668))}},e=>{e.O(0,[40,441,255,358],()=>e(e.s=8041)),_N_E=e.O()}]);