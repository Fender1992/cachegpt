(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[397],{1839:(e,r,t)=>{Promise.resolve().then(t.bind(t,6932))},2855:(e,r,t)=>{"use strict";t.d(r,{N:()=>i});var s=t(5040);let n="https://slxgfzlralwbpzafbufm.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNseGdmemxyYWx3YnB6YWZidWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NzgwMzQsImV4cCI6MjA3MzU1NDAzNH0.0TRSpP_OxAde0WkVXJohGWIqlJ2CdpiYt6FAh2lz1so",i=n&&a?(0,s.UU)(n,a):(()=>{let e="Supabase is not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables.";return{auth:{getUser:()=>Promise.reject(Error(e)),signInWithPassword:()=>Promise.reject(Error(e)),signUp:()=>Promise.reject(Error(e)),signOut:()=>Promise.reject(Error(e)),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}}),getSession:()=>Promise.reject(Error(e))},from:()=>({select:()=>Promise.reject(Error(e)),insert:()=>Promise.reject(Error(e)),update:()=>Promise.reject(Error(e)),delete:()=>Promise.reject(Error(e))}),rpc:()=>Promise.reject(Error(e))}})();n&&a||console.error("Missing required Supabase environment variables.","\nNEXT_PUBLIC_SUPABASE_URL:",n?"Set":"Missing","\nNEXT_PUBLIC_SUPABASE_ANON_KEY:",a?"Set (hidden)":"Missing","\n\nFor Vercel deployment:","\n1. Go to your Vercel project settings","\n2. Navigate to Environment Variables","\n3. Add both variables for Production environment","\n4. Redeploy your application")},3209:(e,r,t)=>{"use strict";t.d(r,{Wu:()=>c,ZB:()=>l,Zp:()=>i,aR:()=>o});var s=t(5155),n=t(2115),a=t(5016);let i=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});i.displayName="Card";let o=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",t),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});l.displayName="CardTitle",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",t),...n})}).displayName="CardDescription";let c=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",t),...n})});c.displayName="CardContent",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},5016:(e,r,t)=>{"use strict";t.d(r,{cn:()=>a});var s=t(2821),n=t(5889);function a(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,s.$)(r))}},6932:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>y});var s=t(5155),n=t(2115),a=t(2855),i=t(9943),o=t(3209),l=t(9277),c=t(5016);let d=n.forwardRef((e,r)=>{let{className:t,children:n,...a}=e;return(0,s.jsxs)(l.bL,{ref:r,className:(0,c.cn)("relative overflow-hidden",t),...a,children:[(0,s.jsx)(l.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,s.jsx)(u,{}),(0,s.jsx)(l.OK,{})]})});d.displayName=l.bL.displayName;let u=n.forwardRef((e,r)=>{let{className:t,orientation:n="vertical",...a}=e;return(0,s.jsx)(l.VM,{ref:r,orientation:n,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...a,children:(0,s.jsx)(l.lr,{className:"relative flex-1 rounded-full bg-border"})})});u.displayName=l.VM.displayName;var m=t(7812),x=t(2467);let f=(0,t(3101).F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=n.forwardRef((e,r)=>{let{className:t,variant:n,size:a,asChild:i=!1,...o}=e,l=i?x.DX:"button";return(0,s.jsx)(l,{className:(0,c.cn)(f({variant:n,size:a,className:t})),ref:r,...o})});h.displayName="Button";var p=t(9559),g=t(508),v=t(9847),j=t(7586),N=t(9332),b=t(6983);function y(){let{user:e,loading:r}=(0,i.A)(),[t,l]=(0,n.useState)([]),[c,u]=(0,n.useState)(!0),[x,f]=(0,n.useState)(null),[y,w]=(0,n.useState)([]),[_,E]=(0,n.useState)(!1);async function C(){try{let{data:e,error:r}=await a.N.from("conversation_summaries").select("*").order("last_updated",{ascending:!1});if(r)throw r;l(e||[])}catch(e){console.error("Error fetching conversations:",e)}finally{u(!1)}}async function A(){if(e){E(!0);try{let e=localStorage.getItem("claude_user_id");if(e){let{data:r,error:t}=await a.N.rpc("claim_conversations_by_claude_user",{claude_uid:e});if(t)throw t;console.log("Claimed ".concat(r," conversations")),await C()}}catch(e){console.error("Error claiming conversations:",e)}finally{E(!1)}}}async function S(e){try{let{data:r,error:t}=await a.N.from("claude_messages").select("*").eq("conversation_id",e).order("timestamp",{ascending:!0});if(t)throw t;w(r||[])}catch(e){console.error("Error fetching messages:",e)}}(0,n.useEffect)(()=>{r||C()},[e,r]),(0,n.useEffect)(()=>{x&&S(x)},[x]);let P=e=>new Date(e).toLocaleString(),k=e=>e?e.toLocaleString():"0";if(r)return(0,s.jsx)("div",{className:"container mx-auto p-6",children:(0,s.jsx)("div",{children:"Loading..."})});if(!e)return(0,s.jsx)("div",{className:"container mx-auto p-6",children:(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Authentication Required"})}),(0,s.jsxs)(o.Wu,{children:[(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please log in to view your conversations."}),(0,s.jsx)(h,{onClick:()=>window.location.href="/login",children:"Go to Login"})]})]})});let I=t.filter(e=>!e.auth_user_id).length;return(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Claude Conversations"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[I>0&&(0,s.jsxs)(h,{onClick:A,disabled:_,variant:"outline",children:[_?(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Claim ",I," Unclaimed Conversations"]}),(0,s.jsxs)(h,{onClick:C,variant:"outline",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Conversations"})}),(0,s.jsx)(o.Wu,{className:"p-0",children:(0,s.jsx)(d,{className:"h-[600px]",children:c?(0,s.jsx)("div",{className:"p-4",children:"Loading..."}):0===t.length?(0,s.jsx)("div",{className:"p-4 text-muted-foreground",children:"No conversations synced yet. Run `llm-cache sync-claude` to sync your Claude Code conversations."}):(0,s.jsx)("div",{className:"divide-y",children:t.map(e=>(0,s.jsxs)("div",{className:"p-4 cursor-pointer hover:bg-accent transition-colors ".concat(x===e.id?"bg-accent":""),onClick:()=>f(e.id),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm font-medium truncate max-w-[200px]",children:e.project_path.split("/").pop()||"Unknown"})]}),(0,s.jsxs)(m.E,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(j.A,{className:"h-3 w-3 mr-1"}),e.message_count]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(N.A,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.git_branch})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[(0,s.jsx)(b.A,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:P(e.last_updated)})]}),(e.total_input_tokens||e.total_output_tokens)&&(0,s.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Tokens: ",k(e.total_input_tokens)," in / ",k(e.total_output_tokens)," out"]})]},e.id))})})})]})}),(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Messages"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsx)(d,{className:"h-[600px]",children:x?0===y.length?(0,s.jsx)("div",{className:"text-muted-foreground",children:"No messages to display"}):(0,s.jsx)("div",{className:"space-y-4",children:y.map(e=>{var r;return(0,s.jsxs)("div",{className:"p-4 rounded-lg ".concat("user"===e.role?"bg-blue-50 dark:bg-blue-950 ml-8":"bg-gray-50 dark:bg-gray-900 mr-8"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)(m.E,{variant:"user"===e.role?"default":"secondary",children:e.role}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:P(e.timestamp)})]}),(null==(r=e.content)?void 0:r.content)&&(0,s.jsx)("div",{className:"mt-2 text-sm",children:Array.isArray(e.content.content)?e.content.content.map((e,r)=>(0,s.jsxs)("div",{className:"mb-2",children:["text"===e.type&&(0,s.jsx)("p",{children:e.text}),"tool_use"===e.type&&(0,s.jsxs)("div",{className:"p-2 bg-secondary rounded text-xs font-mono",children:["Tool: ",e.name]}),"tool_result"===e.type&&(0,s.jsx)("div",{className:"p-2 bg-secondary rounded text-xs",children:(0,s.jsxs)("details",{children:[(0,s.jsx)("summary",{className:"cursor-pointer",children:"Tool Result"}),(0,s.jsx)("pre",{className:"mt-2 overflow-x-auto",children:e.content})]})})]},r)):(0,s.jsx)("p",{children:String(e.content.content)})})]},e.id)})}):(0,s.jsx)("div",{className:"text-muted-foreground",children:"Select a conversation to view messages"})})})]})})]})]})}},7812:(e,r,t)=>{"use strict";t.d(r,{E:()=>o});var s=t(5155);t(2115);var n=t(3101),a=t(5016);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:t,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)(i({variant:t}),r),...n})}},9943:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(2115),n=t(2855);function a(){let[e,r]=(0,s.useState)(null),[t,a]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await n.N.auth.getUser();r(e)}catch(e){}finally{a(!1)}})();let{data:{subscription:e}}=n.N.auth.onAuthStateChange((e,t)=>{var s;r(null!=(s=null==t?void 0:t.user)?s:null)});return()=>{var r;return null==e||null==(r=e.unsubscribe)?void 0:r.call(e)}},[]),{user:e,loading:t}}}},e=>{e.O(0,[40,167,60,441,255,358],()=>e(e.s=1839)),_N_E=e.O()}]);